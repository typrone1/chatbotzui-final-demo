"use strict";var picture,deferredPrompt,shareImageButton=document.querySelector("#share-image-button"),createPostArea=document.querySelector("#create-post"),closeCreatePostModalButton=document.querySelector("#close-create-post-modal-btn"),sharedMomentsArea=document.querySelector("#shared-moments"),form=document.querySelector("form"),titleInput=document.querySelector("#title"),locationInput=document.querySelector("#location"),videoPlayer=document.querySelector("#player"),canvasElement=document.querySelector("#canvas"),captureButton=document.querySelector("#capture-btn"),imagePicker=document.querySelector("#image-picker"),imagePickerArea=document.querySelector("#pick-image"),locationBtn=document.querySelector("#location-btn"),locationLoader=document.querySelector("#location-loader"),fetchedLocation={lat:0,lng:0},enableNotificationsButtons=document.querySelectorAll(".enable-notifications");function askForNotificationPermission(){Notification.requestPermission(function(e){console.log("User Choice",e),"granted"!==e&&console.log("No notification permission granted!")})}if(window.Promise||(window.Promise=Promise),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(function(){console.log("Service worker registered!")}).catch(function(e){console.log(e)}),window.addEventListener("beforeinstallprompt",function(e){return console.log("beforeinstallprompt fired"),e.preventDefault(),deferredPrompt=e,!1}),"Notification"in window&&"serviceWorker"in navigator)for(var i=0;i<enableNotificationsButtons.length;i++)enableNotificationsButtons[i].style.display="inline-block",enableNotificationsButtons[i].addEventListener("click",askForNotificationPermission);function openCreatePostModal(){setTimeout(function(){createPostArea.style.transform="translateY(0)"},1),initializeLocation(),deferredPrompt&&(deferredPrompt.prompt(),deferredPrompt.userChoice.then(function(e){console.log(e.outcome),"dismissed"===e.outcome?console.log("User cancelled installation"):console.log("User added to home screen")}),deferredPrompt=null)}function closeCreatePostModal(){locationBtn.style.display="inline",locationLoader.style.display="none",setTimeout(function(){createPostArea.style.transform="translateY(100vh)"},1)}function initializeLocation(){"geolocation"in navigator||(locationBtn.style.display="none")}shareImageButton.addEventListener("click",openCreatePostModal),closeCreatePostModalButton.addEventListener("click",closeCreatePostModal),locationBtn.addEventListener("click",function(e){if("geolocation"in navigator){var o=!1;locationBtn.style.display="none",locationLoader.style.display="block",navigator.geolocation.getCurrentPosition(function(e){locationBtn.style.display="inline",locationLoader.style.display="none",fetchedLocation={lat:e.coords.latitude,lng:0},locationInput.value="In Munich",document.querySelector("#manual-location").classList.add("is-focused")},function(e){console.log(e),locationBtn.style.display="inline",locationLoader.style.display="none",o||(alert("Couldn't fetch location, please enter manually!"),o=!0),fetchedLocation={lat:0,lng:0}},{timeout:7e3})}});